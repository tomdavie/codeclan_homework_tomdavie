---
title: "Probability homework"
output:
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    df_print: paged
    css: ../../../styles.css
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, messages = FALSE, fig.align = 'center')
```


# MVP - The Titanic

```{r, echo=FALSE, fig.cap="**Fig. 1.** The RMS Titanic leaving Southport, 10th April 1912 (public domain)", out.width = '60%'}
knitr::include_graphics("images/RMS_Titanic.jpg")
```

A data set detailing the survival or death of passengers and crew members on the RMS Titanic is given in the `data` folder for this homework - use this data and **not** the built-in `Titanic` dataset in `R`. 

Some time after the disaster a journalist wrote that crew members were *more likely* to have survived the sinking than passengers. This was disputed by a descendant of one of the surviving crew members, who suggested that the opposite was true, i.e. passengers were *more likely* to have survived than crew.  

You're going to calculate the conditional probabilities $\textrm{prob}(\textrm{ survived } \mid \textrm{ crew })$ and $\textrm{prob}(\textrm{ survived } \mid \textrm{ passenger })$ to settle this dispute.

Have a look at the distinct values of the `class` variable, this will tell you whether each individual was a passenger (1st, 2nd or 3rd class) or a member of the crew (treat restaurant staff as crew)

**Loading packages**

You may want to use `prob` and `gtools` later in the homework, and the `tidyverse` for this section, but if you load `prob` after `tidyverse`, `dplyr::filter()` will be masked. So load your packages in this order:

```{r, message = FALSE}
library(prob)
library(gtools)
library(tidyverse)
library(janitor)
```

**Hints**

* You may want to create a `crew` column containing values `TRUE` or `FALSE` to help with this
* For $\textrm{prob}(\textrm{ survived } \mid \textrm{ crew })$ think 'what proportion of the crew survived?', and similar for $\textrm{prob}(\textrm{ survived } \mid \textrm{ passenger })$ 

```{r}
titanic <- read_csv("data/titanic.csv")
```

```{r}
titanic <- titanic %>% 
  mutate(crew = 
  case_when(fare == 0 ~ TRUE,
            fare > 0 ~ FALSE)
  )
```

```{r}
c_table <- titanic %>% 
  tabyl(crew, survived)
```

```{r}
c_table <- c_table %>% 
  adorn_totals(where = c("row", "col")) 
```

```{r}
c_table <- c_table %>% 
  adorn_percentages(denominator = "all") %>% 
  adorn_title()
```

# Passengers more likely to survive

<br><br>


# MVP and Extension - Probability problems

Today was pretty full-on! Here are some problems to help you consolidate what you learned. Feel free to work on paper or in `R`, whichever you are most comfortable with:

**MVP - try _four_ of the problems**  
**Extension - try more than four!**

<br>
1. If I roll a six-sided dice once, what is the probability of getting a number less than 5?

```{r}
six_sided_dice <- rolldie(1) %>% 
  filter(X1 < 5) %>% 
  summarise(p = n()/nrow(six_sided_dice))
```


<br>
2. How many outcomes are there in the sample space of an experiment in which we toss three dice?

```{r}
toss_three_dice <- rolldie(3)
```

#216

<br>
3. In an experiment where we roll four dice:

  * how many outcomes are in the event where the total of the four dice equals $5$, $6$ or $7$)?
  * what is the probability of this event?
  * what assumptions do we apply in answering part ii?
  
```{r}
four_dice <- rolldie(4)

four_dice <- four_dice %>% 
  mutate(total = rowSums(four_dice))

four_dice %>% 
  filter(total >= 5 & total <= 7) %>% 
  summarise(p = nrow(.)/nrow(four_dice))

```


**Hint**
For part i, `rowSums(.)` may help you setup up the necessary random variable `total` (or you can use `pivot_longer()`)


<br>
4. Five chairs are placed in a row in a room, along with five people of differing height. The people sit down randomly on the chairs. What is the probability that they sit in order of decreasing height, left to right?

**Hint**
This is an arrangement where order matters. Of all the possible arrangements, how many are correct?

```{r}
people <- c("A", "B", "C", "D", "E")

chairs_height <- as_tibble(
  permutations(n = 5,
               r = 5,
               v = people,
               repeats.allowed = FALSE
  )
)

chairs_height_perm <- chairs_height %>% 
  filter(V1 == "A",
         V2 == "B",
         V3 == "C",
         V4 == "D",
         V5 == "E")

prob <- nrow(chairs_height_perm) / nrow(chairs_height)

```


<br>
5. I roll six dice:

  * what is the probability I see the numbers 6, 5, 4, 3, 2 and 1 in order on the dice, left to right?
  * what is the probability I see one each of the numbers 6, 5, 4, 3, 2 and 1 on the dice regardless of order?
  
[**Hint** have a look at the `isin()` function in the `prob` package. For example, to `filter` all rows containing $6$, $1$, $2$ in that order, you could use `isin(., c(6, 1, 2), ordered = TRUE)`]
  
<br>
6. If I draw a single card from a 52-card deck, and it is black, what is the probability that its suit is spades? <br>

**Hints**

* Investigate the `cards()` function in the `prob` package, if you'd like to try this in R (make a deck without jokers). 
* You could think about adding your own `black_card` random variable to the sample space, which would be `TRUE` if the `suit` is 'Spade' or 'Club', and `FALSE` otherwise.

